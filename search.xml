<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>docker创建weblogic的方式</title>
      <link href="/posts/ff3e.html"/>
      <url>/posts/ff3e.html</url>
      
        <content type="html"><![CDATA[<p>前言：较为详细的一次搭建weblogic的方式，因为vulhub上面的weblogic环境生成的tar包传不上去，才有了这用dockerfile创建的环境</p><h1 id="Docker-Weblogic-10-3-6"><a href="#Docker-Weblogic-10-3-6" class="headerlink" title="Docker-Weblogic 10.3.6"></a>Docker-Weblogic 10.3.6</h1><ul><li>基础环境准备</li><li>安装weblogic</li><li>生成weblogic基础镜像</li><li>编制 Dockerfile 定制镜像</li></ul><h2 id="基础环境准备"><a href="#基础环境准备" class="headerlink" title="基础环境准备"></a>基础环境准备</h2><p><strong>1. 拉取并保存centos镜像</strong></p><pre><code>$ sudo docker pull centos$ sudo docker save -o centos-7.2.tar centos:latest</code></pre><p><strong>2. 下载jdk rpm包</strong><br><a href="https://www.oracle.com/technetwork/java/javase/downloads/java-archive-downloads-javase7-521261.html#jdk-7u80-oth-JPR" target="_blank" rel="noopener">rpm:jdk-7u80-64bit</a> </p><p><strong>3. 下载weblogic的zip版安装包</strong><br><a href="https://www.oracle.com/technetwork/middleware/weblogic/downloads/wls-for-dev-1703574.html" target="_blank" rel="noopener">ZIP: weblogic-10.3.6-develop-zip</a> </p><p><strong>4. 安装包准备</strong></p><pre><code># 新建文件夹 CVE-Docker$ mkdir CVE-Docker# 将weblogic安装包及jdk安装包拷贝至 CVE-Docker$ cp *.* /home/tim/CVE-Docker# 解压wls1036_dev.zip,解压后的顶层文件目录是wls10360$ sudo unzip wls1036_dev.zip -d wls10360</code></pre><p><strong>5. 导入centos基础镜像</strong></p><pre><code>$ sudo docker load -i centos-7.2.tar</code></pre><h2 id="安装weblogic"><a href="#安装weblogic" class="headerlink" title="安装weblogic"></a>安装weblogic</h2><pre><code># step1 运行基础centos容器,把安装包目录映射到容器的home目录中$ sudo docker run -itd -P -v /home/tim/CVE-Docker:/tmp --name "install_weblogic" centos:latest /bin/bash# step2 进入容器$ sudo docker exec -it install_weblogic /bin/bash# step3 设置root口令[root@d5896162f9fe /]# passwd rootrootroot# step4 创建weblogic用户[root@d5896162f9fe home]# useradd weblogic -p weblogic123# step5 安装jdk[root@d5896162f9fe home]# cd /tmp[root@d5896162f9fe home]# rpm -ivh jdk-7u80-linux-x64.rpm# step6 寻找jdk安装目录，并复制[root@d5896162f9fe jdk1.7.0_80]# find / -name "*jdk*"# step7 设置weblogic安装目录[root@d5896162f9fe jdk1.7.0_80]# mkdir -p /opt/Oracle/weblogic/wls10360# step8 设置环境变量，在profile尾部添加如下配置[root@d5896162f9fe jdk1.7.0_80]# vi /etc/profileexport JAVA_HOME=/usr/java/jdk1.7.0_80export PATH=$JAVA_HOME/bin:$PATHexport CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jarexport MW_HOME=/opt/Oracle/weblogic/wls10360# step9 使环境变量生效[root@d5896162f9fe jdk1.7.0_80]# source /etc/profile# step10  将weblogic安装包文件拷贝至安装目录[root@d5896162f9fe wls10360]# cd /tmp/wls10360[root@d5896162f9fe wls10360]# cp -R ./* /opt/Oracle/weblogic/wls10360/# step11 将weblogic安装目录及文件所有者修改为weblogic用户[root@d5896162f9fe weblogic]# cd /opt[root@d5896162f9fe opt]# chown -R weblogic:weblogic Oracle/# step12 切换至weblogic用户[root@d5896162f9fe wls10360]# su - weblogic# step12 检查当前环境是否符合weblogic安裝要求[weblogic@d5896162f9fe ~]$ cd /opt/Oracle/weblogic/wls10360/[weblogic@d5896162f9fe wls10360]$ ./configure.sh# step13 配置weblogic初始化参数[weblogic@d5896162f9fe wls10360]$ wlserver/server/bin/setWLSEnv.sh#step14 创建weblogic域(domain)[weblogic@d5896162f9fe wls10360]$ wlserver/common/bin/config.sh#step15 选1,创建新域#step16 选1, 选择WebLogic平台组件 #step17 默认回车, Basic WebLogic Server Domain - 10.3.6.0 [wlserver]#step18 默认回车,使用base_domain作为域名#step19 默认鬼扯,使用/opt/Oracle/weblogic/wls10360/user_projects/domains作为域的安装路径#step20 选1,设置登录管理员用户名,设置为weblogic回车#step21 选2,设置登录管理员用户口令,设置为weblogic123回车#step22 选3,确认登录管理员用户口令,输入weblogic123回车#step23 回车进入下一步,选择1,开发环境#step24 选1,选择我们安装的jdk作为java环境#step25 选1,因为我们只安装单节点,所以选1,如果要部署集群则选择2#step26 默认回车,确认weblogic 管理服务信息，回车进行确认# step27 启动weblogic,测试安装成效[weblogic@d5896162f9fe wls10360]$ user_projects/domains/base_domain/startWebLogic.sh#step28 切换到root用户,安装net-tools软件包,查看服务[root@d5896162f9fe /]# yum install net-tools[root@d5896162f9fe /]# netstat -ntlp[root@d5896162f9fe /]# curl http://127.0.0.1:7001/console</code></pre><h2 id="生成weblogic基础镜像"><a href="#生成weblogic基础镜像" class="headerlink" title="生成weblogic基础镜像"></a>生成weblogic基础镜像</h2><p><strong>1. 生成weblogic基础镜像</strong></p><pre><code>$ sudo docker commit install_weblogic weblogic:10.3.6</code></pre><h2 id="编制-Dockerfile-定制镜像"><a href="#编制-Dockerfile-定制镜像" class="headerlink" title="编制 Dockerfile 定制镜像"></a>编制 Dockerfile 定制镜像</h2><p><strong>1. 编制Dockerfile文件</strong></p><pre><code># Version 1.0# base imageFROM weblogic:10.3.6# Author informationsMAINTAINER 779602274@qq.com# 将启动后的目录切换到 /home/weblogic目录WORKDIR  /home/weblogic# Add the locate file to containerADD start.sh /home/weblogic# 使用root用户来执行后续命令USER root# Running some commondsRUN source /etc/profileRUN chown weblogic:weblogic /home/weblogic/start.shRUN chmod +x /home/weblogic/start.sh# 使用weblogic用户来执行后续命令USER weblogic# Expose the port 7001EXPOSE 7001# The commond running after container startedCMD ["/home/weblogic/start.sh"]</code></pre><p><strong>2.编制附加文件start.sh</strong></p><pre><code>#!/bin/bashsource /etc/profile/opt/Oracle/weblogic/wls10360/user_projects/domains/base_domain/startWebLogic.sh</code></pre><p><strong>3.制作最终镜像</strong></p><pre><code>$ sudo docker build -t weblogic:10.3.6 .</code></pre><p><img src="https://ashupup.oss-cn-beijing.aliyuncs.com/img/11.jpg" alt="11"></p>]]></content>
      
      
      <categories>
          
          <category> 环境搭建 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 环境搭建 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
